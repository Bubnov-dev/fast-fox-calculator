$(document).ready((function(){const e=document.querySelectorAll(".calculator__info"),a=document.querySelectorAll(".calculator__info-tooltip");for(let d=0;d<e.length;d++){let i=e[d],r=a[d],n=Popper.createPopper(i,r,{modifiers:[{name:"offset",options:{offset:[0,8]}}]});function t(){r.setAttribute("data-show",""),n.update()}function l(){r.removeAttribute("data-show")}let s=["mouseleave","blur"];["mouseenter","focus"].forEach(e=>{i.addEventListener(e,t)}),s.forEach(e=>{i.addEventListener(e,l)})}document.querySelectorAll(".custom-select").forEach(e=>{new Choices(e,{searchEnabled:!1,itemSelectText:"",placeholder:!0,placeholderValue:"none"})}),input=$("#gerber-file"),input.on("change",(function(e){if(input[0].files[0].size>1e7)input.val("");else{var a="";"zip"==(a=$(this)[0].files&&$(this)[0].files.length>1?(this.getAttribute("data-multiple-caption")||"").replace("{count}",this.files.length):e.target.value.split("\\").pop()).split(".").pop()?$("#gerber-subtitle").html(a):input.val("")}}));let d=new Map([["materials",new Map([["FR-4",1],["Alu",1.15]])],["layers",new Map([["1",1],["2",1.2],["4",1.8],["6",2.5]])],["designs",new Map([["1",1],["2",1.2],["3",1.8],["4",2.5]])],["width-plate",new Map([["0.4",1],["0.6",1.2],["0.8",1.8],["1.0",2.5]])],["finish",new Map([["HASL",1],["LFHASL",1.2],["ENIG",1.8]])],["width-cu",new Map([["35",1],["70",1.2]])]]),i=[[5,10],[10,9],[20,8],[30,7],[50,6],[80,5],[100,3],[500,1.8],[1e3,1.7],[2e3,1.6],[3e3,1.5],[5e3,1.4]];jQuery.expr[":"].regex=function(e,a,t){var l=t[3].split(","),d=/^(data|css):/,i={method:l[0].match(d)?l[0].split(":")[0]:"attr",property:l.shift().replace(d,"")};return new RegExp(l.join("").replace(/^\s+|\s+$/g,""),"ig").test(jQuery(e)[i.method](i.property))};let r=!0;function n(){$("input").removeAttr("disabled"),"alu"==$('[name="materials"]:checked').val()&&($('[name="layers"]:regex(value, 2|4|6)').attr("disabled","disabled"),$('[name="width-plate"]:regex(value, 0.4|0.6|0.8|2.0)').attr("disabled","disabled"),$('[name="color-mask"]:regex(value, purple|red|yellow|blue)').attr("disabled","disabled"),$('[name="finish"]:regex(value, ENIG)').attr("disabled","disabled"),$('[name="width-cu"]:regex(value, 70)').attr("disabled","disabled")),"1"==$('[name="layers"]:checked').val()&&($('[name="width-plate"]:regex(value, 0.4|0.6|0.8)').attr("disabled","disabled"),$('[name="color-mask"]:regex(value, purple)').attr("disabled","disabled"),$('[name="width-cu"]:regex(value, 70)').attr("disabled","disabled")),"4"==$('[name="layers"]:checked').val()&&($('[name="width-plate"]:regex(value, 0.4|0.6)').attr("disabled","disabled"),$('[name="width-cu"]:regex(value, 70)').attr("disabled","disabled")),"6"==$('[name="layers"]:checked').val()&&($('[name="width-plate"]:regex(value, 0.4|0.6|0.8|1.0)').attr("disabled","disabled"),$('[name="color-mask"]:regex(value, purple)').attr("disabled","disabled")),"service"==$('[name="panels"]').val()&&($('[name="designs"]:regex(value, [2-9])').attr("disabled","disabled"),$('[name="width-plate"]:regex(value, 0.4)').attr("disabled","disabled")),-1==$.inArray($('[name="panels"]').val(),["client","service"])&&$("input:regex(name, numX|numY)").attr("disabled","disabled"),-1!=$.inArray($('[name="width-plate"]:checked').val(),["0.4","0.6","0.8","1.0","1.2"])&&$('[name="width-cu"]:regex(value, 70)').attr("disabled","disabled"),-1!=$.inArray($('[name="width-plate"]:checked').val(),["0.4","0.6"])&&$('[name="layers"]:regex(value, 1|4|6)').attr("disabled","disabled"),-1!=$.inArray($('[name="width-plate"]:checked').val(),["0.4"])&&($('[name="finish"]:regex(value, LFHASL|ENIG)').attr("disabled","disabled"),$('[name="color-mask"]:regex(value, red|yellow)').attr("disabled","disabled")),"purple"==$('[name="color-mask"]:checked').val()&&($('[name="width-plate"]:regex(value, 0.4|0.6)').attr("disabled","disabled"),$('[name="layers"]:regex(value, 1|6)').attr("disabled","disabled")),-1!=$.inArray($('[name="color-mask"]:checked').val(),["red","yellow"])&&$('[name="width-plate"]:regex(value, 0.4)').attr("disabled","disabled"),"black"==$('[name="color-mask"]:checked').val()&&$('[name="width-cu"]:regex(value, 70)').attr("disabled","disabled"),"white"==$('[name="color-mask"]:checked').val()?$("#sh-color-black").prop("checked",!0):$("#sh-color-white").prop("checked",!0),$("[disabled]").prop("checked",!1),s();let e=new Set;$('input[type="radio"]').each((function(){e.add($(this).attr("name"))})),e.forEach((e,a,t)=>{let l=$("input[name="+e+"]:not([disabled])");1==l.length&&l.prop("checked",!0)}),r?(r=!1,n()):r=!0}function s(){let e=1;$("input:checked").each((function(){let a=$(this),t=d.get($(this).attr("name"));t&&t.get(a.attr("value"))&&(e*=t.get(a.attr("value")))})),console.log("cf = "+e);let a=1;try{a=$("#width").val()*$("#height").val()/1e4*$('[name="panels-num"]').val()}catch{a=1}let t=[i[0][1]];for(let e=0;e<i.length;e++)i[e][0]>a&&(t=i[e][1],e=i.length);let l=Math.ceil(t*e*a);$(".calculator__result-price-rub .calculator__result-value").html(l)}n(),$("input, select").on("change",(function(){n()})),$('input[type="text"]').on("keyup",(function(){let e=$(this).val();e=e.replace(/[^0-9]/g,""),$(this).val(e),s()}))}));